<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ML Science Benchmarks â€“ Tutorials</title>
    <link>/mlcommons/docs/tutorials/</link>
    <description>Recent content in Tutorials on ML Science Benchmarks</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Wed, 04 Jan 2017 00:00:00 +0000</lastBuildDate>
    
	  <atom:link href="/mlcommons/docs/tutorials/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Docs: Running GPU Batch jobs on Rivanna</title>
      <link>/mlcommons/docs/tutorials/rivanna/</link>
      <pubDate>Thu, 05 Jan 2017 00:00:00 +0000</pubDate>
      
      <guid>/mlcommons/docs/tutorials/rivanna/</guid>
      <description>
        
        
        

&lt;div class=&#34;pageinfo pageinfo-primary&#34;&gt;
&lt;p&gt;We explain how to run GPU batch jobs using different GPU cards on
Rivanna. Rivanna is a supercomputer at the University of Virginia. This
tutorial is only useful if you can get an account on it. The
official documentation is available at&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/overview/&#34;&gt;https://www.rc.virginia.edu/userinfo/rivanna/overview/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, it includes some issues and does not explain certain
important aspects for using GPUs on it. Therefore, this guide has been
created.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PLEASE HELP US IMPROVE THIS GUIDE&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;



&lt;div class=&#34;alert alert-warning&#34; role=&#34;alert&#34;&gt;
&lt;h4 class=&#34;alert-heading&#34;&gt;Requirements&lt;/h4&gt;

    &lt;p&gt;We require that you have&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A valid account on Rivanna&lt;/li&gt;
&lt;li&gt;A valid accounting group allowing you to run GPU jobs on Rivanna&lt;/li&gt;
&lt;/ul&gt;


&lt;/div&gt;

&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Rivanna is the High-Performance Computing (HPC) cluster
managed by University of Virginia&amp;rsquo;s Research Computing. Rivanna is
composed 575 nodes with a total of 20,476 cores and 8PB of different
types of storage. Table 1 shows an overview of the compute
nodes. Some of the compute nodes also includes these GPUs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.nvidia.com/en-us/data-center/a100/&#34;&gt;A100&lt;/a&gt;,
&lt;a href=&#34;https://www.nvidia.com/en-gb/data-center/tesla-k80/&#34;&gt;K80&lt;/a&gt;,
&lt;a href=&#34;https://www.nvidia.com/en-us/data-center/tesla-p100/&#34;&gt;P100&lt;/a&gt;,
&lt;a href=&#34;https://www.nvidia.com/en-us/data-center/v100/&#34;&gt;V100&lt;/a&gt;,
&lt;a href=&#34;https://www.nvidia.com/en-us/geforce/20-series/&#34;&gt;RTX2080&lt;/a&gt;,
and
&lt;a href=&#34;https://www.nvidia.com/en-us/geforce/graphics-cards/30-series/rtx-3090/&#34;&gt;RTX3090&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Table 1:&lt;/strong&gt; GPUs on Rivanna&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Cores/Node&lt;/th&gt;
&lt;th&gt;Memory/Node&lt;/th&gt;
&lt;th&gt;Specialty Hardware&lt;/th&gt;
&lt;th&gt;GPU memory/Device&lt;/th&gt;
&lt;th&gt;GPU devices/Node&lt;/th&gt;
&lt;th&gt;# of Nodes&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;40&lt;/td&gt;
&lt;td&gt;354GB&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;127GB&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;115&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;255GB&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;40&lt;/td&gt;
&lt;td&gt;768GB&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;34&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;40&lt;/td&gt;
&lt;td&gt;384GB&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;348&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;550GB&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;1000GB&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;48&lt;/td&gt;
&lt;td&gt;1500GB&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;64&lt;/td&gt;
&lt;td&gt;180GB&lt;/td&gt;
&lt;td&gt;KNL&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;128&lt;/td&gt;
&lt;td&gt;1000GB&lt;/td&gt;
&lt;td&gt;GPU: A100&lt;/td&gt;
&lt;td&gt;40GB&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;255GB&lt;/td&gt;
&lt;td&gt;GPU: K80&lt;/td&gt;
&lt;td&gt;11GB&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;255GB&lt;/td&gt;
&lt;td&gt;GPU: P100&lt;/td&gt;
&lt;td&gt;12GB&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;40&lt;/td&gt;
&lt;td&gt;383GB&lt;/td&gt;
&lt;td&gt;GPU: RTX 2080 Ti&lt;/td&gt;
&lt;td&gt;11GB&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;188GB&lt;/td&gt;
&lt;td&gt;GPU: V100&lt;/td&gt;
&lt;td&gt;16GB&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;40&lt;/td&gt;
&lt;td&gt;384GB&lt;/td&gt;
&lt;td&gt;GPU: V100&lt;/td&gt;
&lt;td&gt;32GB&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;*) This information may be outdated&lt;/p&gt;
&lt;h2 id=&#34;access-to-rivanna&#34;&gt;Access to Rivanna&lt;/h2&gt;
&lt;p&gt;Access to Rivanna is secured by &lt;a href=&#34;https://virginia.service-now.com/its/?id=itsweb_kb_article&amp;amp;sys_id=f24e5cdfdb3acb804f32fb671d9619d0&#34;&gt;University of Virginias
VPN&lt;/a&gt;. UVA
offers two different VPNs. We recommend that you install the &lt;strong&gt;UVA
Anywhere VPN&lt;/strong&gt;. This can be installed on Linux, macOS and Windows.&lt;/p&gt;
&lt;p&gt;After installation, you have to start the VPN. After that, you can use a
terminal to access Rivanna via ssh. If you have not used ssh, we
encourage you to read about it and explore commands such as &lt;code&gt;ssh&lt;/code&gt;,
&lt;code&gt;ssh-keygen&lt;/code&gt;, &lt;code&gt;ssh-copy-id&lt;/code&gt;, &lt;code&gt;ssh-agent, and &lt;/code&gt;ssh-add`.&lt;/p&gt;


&lt;div class=&#34;alert alert-warning&#34; role=&#34;alert&#34;&gt;
&lt;h4 class=&#34;alert-heading&#34;&gt;Note: gitbash on Windows&lt;/h4&gt;

    Please note that on Windows, you are expected to install gitbash so
you can use the same commands and ssh logic as on Linux and Mac. For
this reason, we do not recommend &lt;code&gt;putty&lt;/code&gt;, &lt;code&gt;PowerShell&lt;/code&gt; or
&lt;code&gt;cmd.exe&lt;/code&gt;. This is because we can do scripting the same way, even from
those running Windows, and significantly simplifies this guide.

&lt;/div&gt;

&lt;p&gt;We will not provide an extensive tutorial on how to use
ssh, but you can contribute it. Instead, we will summarize the most important steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Create an ssh key if you have not done that before&lt;/p&gt;
&lt;p&gt;&amp;ldquo;`bash
$ ssh-keygen&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;
It is **VERY** important that you create the key with a strong passphrase. 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add an abbreviation for Rivanna to your &lt;code&gt;~/.ssh/config&lt;/code&gt; file&lt;/p&gt;
&lt;p&gt;Use your favorite editor. Mine is &lt;code&gt;emacs&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;emacs ~/.ssh/config&lt;/p&gt;
&lt;p&gt;copy and paste the following into that file, where &lt;code&gt;abc1de&lt;/code&gt; is to be substituted by your
UVA compute id.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;Host rivanna
  User abc1de
  HostName rivanna.hpc.virginia.edu 
  IdentityFile ~/.ssh/id_rsa.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This will allow you to use &lt;code&gt;rivanna&lt;/code&gt; instead of &lt;code&gt;abc1de@rivanna.hpc.virginia.edu&lt;/code&gt;.
The next steps assume you have done this and can use just &lt;code&gt;rivanna&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Copy your public key to rivanna&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ ssh-copi-id rivanna
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This will copy your public key into the
&lt;code&gt;rivanna:~/.ssh/authorized_keys&lt;/code&gt; file.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;After this step, you can use your keys to authenticate. You still
need to be using the VPN, though.&lt;/p&gt;
&lt;p&gt;The most convenient system for it is Mac and Ubuntu. It
already has a tool installed called ssh-agent and keychain. In
Windows under gitbash you need to start it with&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ &lt;span style=&#34;color:#204a87&#34;&gt;eval&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;`&lt;/span&gt;ssh-agent&lt;span style=&#34;color:#4e9a06&#34;&gt;`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;First, you add the key to your session, so you do not have to
constantly type in the password. Use the command&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ ssh-add
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;to test if it works, just say&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ ssh rivanna hostanme
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;which will print the hostname of Rivanna&lt;/p&gt;
&lt;p&gt;In case your machine does not run ssh-agent, you can start it
before you type in the ssh-add command with&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ ssh rivanna hostanme
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If everything is set up correctly, it will return  the string&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;udc-ba35-36
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;To login to Rivanna, simply say&lt;/p&gt;
&lt;p&gt;&amp;ldquo;`bash
ssh rivanna&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;
If this does not work, you have made a mistake. Please, review the
previous steps carefully.

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;running-jobs-on-rivanna&#34;&gt;Running Jobs on Rivanna&lt;/h2&gt;
&lt;p&gt;Jobs on Rivanna can be scheduled through Slurm either as a batch job or
as an interactive job. In order to achieve this, one needs to load the
software first and create special scripts that are used to submit them
to nodes that contain the GPUs you specify.&lt;/p&gt;
&lt;p&gt;The user documentation about this is provided here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/overview/#gpu-partition&#34;&gt;https://www.rc.virginia.edu/userinfo/rivanna/overview/#gpu-partition&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, at the time when we looked at it, it had some mistakes and
limitations that we hope to overcome here.&lt;/p&gt;
&lt;h3 id=&#34;modules&#34;&gt;Modules&lt;/h3&gt;
&lt;p&gt;Rivanna&amp;rsquo;s default mechanism of software configuration management is
done via
&lt;a href=&#34;https://lmod.readthedocs.io/en/latest/index.html&#34;&gt;modules&lt;/a&gt;. The UVA
modules documentation is provided through this
&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/software/modules/&#34;&gt;link&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Modules provide the ability to load a particular software stack and
configuration into your shell but also into your batch jobs. You can
load multiple modules in your environment to load them in order.&lt;/p&gt;
&lt;p&gt;To list the available modules, log into Rivanna and use the command&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;$ module available
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To list aproximately, the python modules use&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;$ module available py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;It will return all modules that have py in it. Please chose those that
look like python modules.&lt;/p&gt;
&lt;p&gt;To probe for deep learning modules, use  something similar to&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;$ module available cuda tensorflow pytorch mxnet nvidia cudnn
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;python&#34;&gt;Python&lt;/h3&gt;
&lt;p&gt;Different versions of python are available.&lt;/p&gt;
&lt;p&gt;To load python 3.8 we can say&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ module load anaconda/2020.11-py3.8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To load Python 3.10.0 we can say&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;$ module load anaconda
$ conda create -n py3.10 python=3.10
$ source activate py3.10
$ python -V
Python 3.10.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Please note that at this time anaconda did not support 3.10.2, which I
run personally on my computer, but from python.org.&lt;/p&gt;
&lt;h3 id=&#34;adding-modules-with-spider&#34;&gt;Adding Modules with Spider&lt;/h3&gt;
&lt;p&gt;Details about modules can be identified with the &lt;code&gt;module spider&lt;/code&gt; command.
If you type it in you get a list of many available configurations.
Spider can take a keyword and lists all available version the keyword matches.
Let us demonstrate it on&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ module spider python
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;----------------------------------------------------------------------------
  python:
----------------------------------------------------------------------------
    Description:
      Python is a programming language that lets you work more effectively.

     Versions:
        python/2.7.16
        python/3.6.6
        python/3.6.8
        python/3.7.7
        python/3.8.8
     Other possible modules matches:
        biopython  openslide-python  wxpython
----------------------------------------------------------------------------
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For detailed information about a specific &amp;ldquo;python&amp;rdquo; package use the module&amp;rsquo;s full name.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ module spider python/3.8.8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This will return a page with lots of information. The most important one for us is&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt; You will need to load all module(s) on any one of the lines below before the
 &amp;#34;python/3.8.8&amp;#34; module is available to load.

      gcc/11.2.0  openmpi/3.1.6
      gcc/9.2.0  cuda/11.0.228  openmpi/3.1.6
      gcc/9.2.0  mvapich2/2.3.3
      gcc/9.2.0  openmpi/3.1.6
      gcccuda/9.2.0_11.0.228  openmpi/3.1.6
      goolfc/9.2.0_3.1.6_11.0.228
 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here you see various options that need to be loaded in &lt;strong&gt;BEFORE&lt;/strong&gt; you load python.&lt;/p&gt;
&lt;p&gt;Thus to properly load python 3.8.8 you need to say (if this is what you chose):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;module load gcc/11.2.0
module load openmpi/3.1.6
module spider python/3.8.8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;containers&#34;&gt;Containers&lt;/h3&gt;
&lt;p&gt;Rivanna uses singularity as container technology. The documentation
specific to singularity for Rivanna is avalable at this
&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/software/containers/&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Singularity needs to be also loaded as a module befor it can be used.&lt;/p&gt;
&lt;p&gt;Singularity containers have the ability to access
&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/software/containers/#running-gpu-images&#34;&gt;GPUs&lt;/a&gt;
via a passthrough using NVidia drivers. Once you load singularity you
can use it as follows:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;singularity &amp;lt;cmd&amp;gt; --nv &amp;lt;imagefile&amp;gt; &amp;lt;args&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The container will be used inside a job.&lt;/p&gt;
&lt;h3 id=&#34;jobs&#34;&gt;Jobs&lt;/h3&gt;
&lt;p&gt;More detail specific to jobs for Rivanna is provided
&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/slurm/#gpu-intensive-computation&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Before we start an example, we explain how we create a job first in a
job description file and then submit it to Rivanna. We use a simple
MNIST example showcases the aspects of successfully running a job on
the machine. We will therefore focus on creating jobs using GPUs.&lt;/p&gt;


&lt;div class=&#34;alert alert-warning&#34; role=&#34;alert&#34;&gt;
&lt;h4 class=&#34;alert-heading&#34;&gt;New 8  A100 GPUs to be added&lt;/h4&gt;

    &lt;p&gt;Rivanna will have eight nodes available to us, but they are not yet in service.&lt;/p&gt;
&lt;p&gt;Instead, we will be using the two existing nodes shared with other users.&lt;/p&gt;


&lt;/div&gt;

&lt;p&gt;Rivanna uses the SLURM job scheduler for allocating submitted jobs.
Jobs are charged SUs from an allocation. The Rivanna compute
allocation. Please contact your supervisor for the name of the allocation. Gregor&amp;rsquo;s allocation is named&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;bii_dsc&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and it currently contains 100,000 SUs.  Students from the UVA capstone
class will have the following allocation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;TBD&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To see the available SUs for your project, please use the command&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;TBD&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;SUs can be requested via the &lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/allocations/&#34;&gt;Standard Allocation Renewal
form&lt;/a&gt;. Due
to the limitation, we encourage you to plan things and try to
avoid unnecessary runs. General instructions for submitting SLURM jobs
is located at&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/slurm/&#34;&gt;https://www.rc.virginia.edu/userinfo/rivanna/slurm/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To request the job be submitted to the GPU partition, you use the option&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-p gpu&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The A100 GPUs are a requestable resource. To request them, you would
add the gres option with the number of A100 GPUs requested (1 through
8 GPUs), for example, to request 2 A100 GPUs,&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--gres=gpu:a100:2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If you are using a SLURM script to submit the job the options
would appear as follows. Your script will need to specify other
options such as the allocation to charge as seen in the sample scripts
shown in the above URL:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;#SBATCH -p gpu
#SBATCH --gres=gpu:a100:2
#SBATCH -A bii_dsc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;interactive-jobs&#34;&gt;Interactive Jobs&lt;/h3&gt;
&lt;p&gt;Please avoid running interactive jobs as they may waste
SUs, and we are charged by you keeping the A100 idle.&lt;/p&gt;
&lt;p&gt;Although Research Computing also offers some interactive apps such as
JupyterLab, RStudio, CodeServer, Blender, Mathematica via our Open
OnDemand portal at:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://rivanna-portal.hpc.virginia.edu&#34;&gt;https://rivanna-portal.hpc.virginia.edu&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;we ask you to avoid using them for benchmarks.&lt;/p&gt;
&lt;p&gt;To request the use of the A100s via Open OnDemand, first log in to the
Open the OnDemand portal select the desired interactive app. You will be
presented with a form to complete. Currently, you would&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;select &lt;code&gt;gpu&lt;/code&gt; for Rivanna partition,&lt;/li&gt;
&lt;li&gt;select &lt;code&gt;NVIDIA A100&lt;/code&gt; from the &lt;code&gt;Optional: GPU type for GPU partition&lt;/code&gt;
pulldown menu and enter the number of desired GPUs from the
&lt;code&gt;Optional: Number of GPUs&lt;/code&gt;. Once you&amp;rsquo;ve completed the form, click
the &lt;code&gt;Launch&lt;/code&gt; button and your session will be launched. The session
will start once the resources are available.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;using-the-mnist-example&#34;&gt;Using the MNIST example&lt;/h3&gt;
&lt;p&gt;For now, the code is located at:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/laszewsk/mlcommons/tree/main/examples/mnist-tensorflow&#34;&gt;https://github.com/laszewsk/mlcommons/tree/main/examples/mnist-tensorflow&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A sample slurm job specification is included at&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/laszewsk/mlcommons/blob/main/examples/mnist-tensorflow/mnist-rivanna-a100.slurm&#34;&gt;https://github.com/laszewsk/mlcommons/blob/main/examples/mnist-tensorflow/mnist-rivanna-a100.slurm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To run it use the command&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ sbatch mnist-rivanna-a100.slurm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;NOTE: We want to improve the script to make sure it is running on a
GPU and add GPU placement commands into the code.&lt;/p&gt;
&lt;h3 id=&#34;custom-version-of-tensorflow&#34;&gt;Custom Version of TensorFlow&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/software/tensorflow/&#34;&gt;https://www.rc.virginia.edu/userinfo/rivanna/software/tensorflow/&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;keras-on-rivanna&#34;&gt;Keras on Rivanna&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.rc.virginia.edu/userinfo/rivanna/software/keras/&#34;&gt;https://www.rc.virginia.edu/userinfo/rivanna/software/keras/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
  </channel>
</rss>
